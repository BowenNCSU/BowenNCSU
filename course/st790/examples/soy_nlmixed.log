1                                                          The SAS System                                10:42 Monday, April 4, 2016

NOTE: Copyright (c) 2002-2012 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.4 (TS1M2) 
      Licensed to NORTH CAROLINA STATE UNIVERSITY-SFA-T&R, Site 70081220.
NOTE: This session is executing on the Linux 2.6.32-573.7.1.el6.x86_64 (LIN X64) platform.



NOTE: Updated analytical products:
      
      SAS/STAT 13.2
      SAS/ETS 13.2
      SAS/OR 13.2
      SAS/IML 13.2

NOTE: Additional host information:

 Linux LIN X64 2.6.32-573.7.1.el6.x86_64 #1 SMP Tue Sep 22 22:00:00 UTC 2015 x86_64 CentOS release 6.7 (Final) 

You are running SAS 9. Some SAS 8 files will be automatically converted 
by the V9 engine; others are incompatible.  Please see 
http://support.sas.com/rnd/migration/planning/platform/64bit.html

PROC MIGRATE will preserve current SAS file attributes and is 
recommended for converting all your SAS libraries from any 
SAS 8 release to SAS 9.  For details and examples, please see
http://support.sas.com/rnd/migration/index.html


This message is contained in the SAS news file, and is presented upon
initialization.  Edit the file "news" in the "misc/base" directory to
display site-specific news and information in the program log.
The command line option "-nonews" will prevent this display.




NOTE: SAS initialization used:
      real time           0.18 seconds
      cpu time            0.03 seconds
      
1          /******************************************************************
2          
3            CHAPTER 9, Soybean study
4          
5            Fit a subject-specific nonlinear mixed effects model to the
6            soybean data using PROC NLIMIXED.  he procedure implments the model using
7            the first order linearization about zero and solving GEE-2
8            equations (METHOD=FIRO) and adaptive Gaussian quadature (the default).
9          
10         ******************************************************************/
11         
12         options ps=55 ls=80 nodate;
13         
2                                The SAS System

14         %inc 'nlmm801.sas' / nosource;
1217       
1218       /******************************************************************
1219       
1220           The data on the first 2 plots are
1221       
1222           1 1988F1 F 1988 14 0.106
1223           1 1988F1 F 1988 21 0.261
1224           1 1988F1 F 1988 28 0.666
1225           1 1988F1 F 1988 35 2.11
1226           1 1988F1 F 1988 42 3.56
1227           1 1988F1 F 1988 49 6.23
1228           1 1988F1 F 1988 56 8.71
1229           1 1988F1 F 1988 63 13.35
1230           1 1988F1 F 1988 70 16.3417
1231           1 1988F1 F 1988 77 17.75083
1232           2 1988F2 F 1988 14 0.104
1233           2 1988F2 F 1988 21 0.269
1234           2 1988F2 F 1988 28 0.778
1235           2 1988F2 F 1988 35 2.12
1236           2 1988F2 F 1988 42 2.93
1237           2 1988F2 F 1988 49 5.29
1238           2 1988F2 F 1988 56 9.5
1239           2 1988F2 F 1988 70 16.9667
1240           2 1988F2 F 1988 77 17.7467
1241       
1242           column 1      plot id (numeric, 48 plots total)
1243           column 2      alternate plot id
1244           column 4      year
1245           column 5      day
1246           column 6      average leaf weight/plant
1247       
1248           NOTE:  These are the data from R, so rounded to 5 decimal places.
1249       
1250       ******************************************************************/
1251       
1252       data soy; infile 'soyR.dat';
1253         input plot id $ geno $ year day lwt;
1254       run;

NOTE: The infile 'soyR.dat' is:
      
      Filename=/home/davidian/ST/Documents/teaching/longitudinal/nlmm_examples/s
      oyR.dat,
      Owner Name=davidian,Group Name=ncsu,
      Access Permission=-rwxr-xr-x,
      Last Modified=04Apr2016:09:08:09,
      File Size (bytes)=10961

NOTE: 412 records were read from the infile 'soyR.dat'.
      The minimum record length was 22.
      The maximum record length was 28.
NOTE: The data set WORK.SOY has 412 observations and 6 variables.
3                                The SAS System

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1255       
1256       data soy; set soy;
1257         d1=0; if geno="F" and year=1988 then d1=1;
1258         d2=0; if geno="P" and year=1988 then d2=1;
1259         d3=0; if geno="F" and year=1989 then d3=1;
1260         d4=0; if geno="P" and year=1989 then d4=1;
1261         d5=0; if geno="F" and year=1990 then d5=1;
1262         d6=0; if geno="P" and year=1990 then d6=1;
1263       run;

NOTE: There were 412 observations read from the data set WORK.SOY.
NOTE: The data set WORK.SOY has 412 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1264       
1265       /*****************************************************************
1266       
1267        PROC NLMIXED is very general, so requires a lot of intervention
1268          by the user to set up the model.  It is necessary to specify
1269          starting values for all parameters.  Starting values for the fixed
1270          effects might be found by fitting the model by OLS taking all
1271          observations to be independent, and then using the NLINMIX macro
1272          or R nlme() to get starting values for the covariance parameters.
1273       
1274          The default integation method is adaptive Gaussian quadrature.
1274     ! The
1275          number of quadrature points (abscissae) is calculated adaptively.
1275     !  If
1276          you want to specify a fixed number of points L, specify
1277       
1278          METHOD=GAUSS QPOINTS=L
1279       
1280          in the PROC NLMIXED statement.  The full Laplace method with no
1281          with no further linearization with QPOINTS=1.  The quadrature
1282          can be made nonadaptive with the NOAD option.
1283       
1284          As shown below, the user has to specify starting values for all
1285          fixed effects and covariance parameters in the PARMS statement.
1286          Programming statements allow the user to specify whatever model
1287          s/he wants, with any sort of nonlinearity.  The MODEL statement
1288          specifies the within-individual conditional distribution.  See
1289          the documentation for the built-in conditional distributions that
1290          are possible - these assume within-individual independence of the
1291          Y_ij.  The user can specify his/her own within-individual
1291     ! conditional
4                                The SAS System

1292          likelihood with some programming.  The RANDOM statement is where
1292     ! one
1293          specifies the random effects - the syntax is pretty obvious.
1294       
1295          See the proc nlmixed documentation for information on syntax,
1296          required statements, and options.
1297       
1298          Here, we fit only the model with covariates with no random effects
1299          for the half-life and growth rate parameters; see the results
1299     ! using
1300          R nlme() and the NLINMIX macro.
1301       
1302       ******************************************************************/
1303       
1304       title "COVARIATES, NO RANDOM EFFECT FOR HALF LIFE OR GROWTH RATE";
1305       proc nlmixed data=soy;
1306           parms beta11=20 beta12=20 beta13=20 beta14=20 beta15=20 beta16=20
1307                 beta21=50 beta22=50 beta23=50 beta24=50 beta25=50 beta26=50
1308                 beta31=0.125 beta32=0.125 beta33=0.125 beta34=0.125
1308     ! beta35=0.125
1309                 beta36=0.125 s12=1 s2=0.04 delta=1;
1310           beta1i=beta11*d1+beta12*d2+beta13*d3+beta14*d4+beta15*d5+beta16*d
1310     ! 6+b1;
1311           beta2i=beta21*d1+beta22*d2+beta23*d3+beta24*d4+beta25*d5+beta26*d
1311     ! 6;
1312           beta3i=beta31*d1+beta32*d2+beta33*d3+beta34*d4+beta35*d5+beta36*d
1312     ! 6;
1313           denom=1+exp(-beta3i*(day-beta2i));
1314           pred=beta1i/denom;
1315           model lwt ~ normal(pred,(pred**(2*delta))*s2);
1316           random b1 ~ normal(0,s12) subject=plot;
1317       run;

NOTE: Convergence criterion (GCONV=1E-8) satisfied.
NOTE: At least one element of the gradient is greater than 1e-3.
NOTE: The PROCEDURE NLMIXED printed pages 1-4.
NOTE: PROCEDURE NLMIXED used (Total process time):
      real time           40.59 seconds
      cpu time            40.57 seconds
      

1318       
1319       

NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           40.85 seconds
      cpu time            40.65 seconds
      
